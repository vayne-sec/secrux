# Production (control-plane node) environment variables
# Copy to `.env` and replace placeholders.

# -----------------------------------------------------------------------------
# Images (optional)
# -----------------------------------------------------------------------------
SECRUX_SERVER_IMAGE=secrux-server:latest
SECRUX_CONSOLE_IMAGE=secrux-console:latest
SECRUX_AI_IMAGE=secrux-ai:latest

# -----------------------------------------------------------------------------
# Ports exposed on the control-plane node
# -----------------------------------------------------------------------------
SECRUX_SERVER_PORT=8080
EXECUTOR_GATEWAY_PORT=5155
CONSOLE_PORT=80
AI_PORT=5156

# -----------------------------------------------------------------------------
# Executor Gateway TLS (recommended)
# -----------------------------------------------------------------------------
# Mount certs into `deploy/production/control-plane/certs/executor-gateway/` and the compose will pick them up.
# Example generation (run from repo root):
#   ./gen-executor-gateway-certs.sh --out-dir deploy/production/control-plane/certs/executor-gateway --dns CONTROL_PLANE_PUBLIC_HOST
EXECUTOR_GATEWAY_CERTIFICATE_PATH=/certs/executor-gateway/gateway.crt
EXECUTOR_GATEWAY_PRIVATE_KEY_PATH=/certs/executor-gateway/gateway.key

# -----------------------------------------------------------------------------
# External infra addresses (reachable from this node)
# -----------------------------------------------------------------------------
SPRING_DATASOURCE_URL=jdbc:postgresql://INFRA_HOST:5432/secrux
SPRING_DATASOURCE_USERNAME=secrux
SPRING_DATASOURCE_PASSWORD=change-me

# AI config DB used by secrux-server (jOOQ aiDslContext + spring.flyway.ai)
SECRUX_AI_DB_URL=jdbc:postgresql://INFRA_HOST:5433/secrux_ai
SECRUX_AI_DB_USERNAME=secrux_ai
SECRUX_AI_DB_PASSWORD=change-me

SECRUX_KAFKA_BOOTSTRAP_SERVERS=INFRA_HOST:19092

SECRUX_AUTH_MODE=KEYCLOAK
SECRUX_AUTH_ISSUER_URI=http://INFRA_HOST:8081/realms/secrux
SECRUX_AUTH_AUDIENCE=secrux-api

# Keycloak admin API used by the server for user/role management
SECRUX_KEYCLOAK_ADMIN_BASE_URL=http://INFRA_HOST:8081
SECRUX_KEYCLOAK_ADMIN_REALM=secrux
SECRUX_KEYCLOAK_ADMIN_CLIENT_ID=secrux-admin
SECRUX_KEYCLOAK_ADMIN_CLIENT_SECRET=changeme

SECRUX_CRYPTO_SECRET=change-me

# AI service (server -> ai-service)
SECRUX_AI_SERVICE_BASE_URL=http://ai-service:5156
SECRUX_AI_SERVICE_TOKEN=change-me

# AI service DB (ai-service -> ai-postgres on infra node)
AI_DATABASE_URL=postgresql+psycopg://secrux_ai:change-me@INFRA_HOST:5433/secrux_ai

# -----------------------------------------------------------------------------
# Console runtime config (what usersâ€™ browsers should reach)
# -----------------------------------------------------------------------------
# URL that executors should use to reach the API (embedded in task payloads)
SECRUX_EXECUTOR_API_BASE_URL=http://CONTROL_PLANE_PUBLIC_HOST:8080

SECRUX_API_BASE_URL=http://CONTROL_PLANE_PUBLIC_HOST:8080
SECRUX_AUTH_MODE_UI=keycloak
SECRUX_OIDC_BASE_URL=http://INFRA_PUBLIC_HOST:8081
SECRUX_OIDC_REALM=secrux
SECRUX_OIDC_CLIENT_ID=secrux-console
SECRUX_OIDC_SCOPE=openid
SECRUX_APP_VERSION=prod
