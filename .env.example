# Quickstart environment variables for `docker compose`.
# Copy to `.env` and adjust for your environment.
#
# IMPORTANT:
# - Never commit real secrets.
# - Executor tokens are passwords; rotate if leaked.

# -----------------------------------------------------------------------------
# Core URLs (Console runtime config)
# -----------------------------------------------------------------------------
SECRUX_API_BASE_URL=http://localhost:8080
SECRUX_AUTH_MODE_UI=keycloak
SECRUX_OIDC_BASE_URL=http://localhost:8081
SECRUX_OIDC_REALM=secrux
SECRUX_OIDC_CLIENT_ID=secrux-console
SECRUX_OIDC_SCOPE=openid
SECRUX_APP_VERSION=dev

# -----------------------------------------------------------------------------
# Postgres (control plane)
# -----------------------------------------------------------------------------
POSTGRES_DB=secrux
POSTGRES_USER=secrux
POSTGRES_PASSWORD=secrux

# -----------------------------------------------------------------------------
# Keycloak (dev admin for container)
# -----------------------------------------------------------------------------
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# -----------------------------------------------------------------------------
# Secrux Server
# -----------------------------------------------------------------------------
SECRUX_SERVER_PORT=8080
SECRUX_KAFKA_BOOTSTRAP_SERVERS=kafka:29092

# Auth (Keycloak)
SECRUX_AUTH_MODE=KEYCLOAK
SECRUX_AUTH_ISSUER_URI=http://keycloak:8081/realms/secrux
# Accept additional issuer values (comma-separated). Useful when Keycloak is accessed via localhost in the browser.
SECRUX_AUTH_ISSUER_ALIASES=http://localhost:8081/realms/secrux
SECRUX_AUTH_AUDIENCE=secrux-api

# Encryption key for stored credentials (REQUIRED for production; quickstart can use a dev value)
SECRUX_CRYPTO_SECRET=change-me-in-production

# Secrux Server AI config DB (jOOQ aiDslContext + spring.flyway.ai)
# Defaults to the bundled ai-postgres container in quickstart.
SECRUX_AI_DB_URL=jdbc:postgresql://ai-postgres:5432/secrux_ai
SECRUX_AI_DB_USERNAME=secrux_ai
SECRUX_AI_DB_PASSWORD=secrux_ai

# AI service integration (server -> AI)
SECRUX_AI_SERVICE_BASE_URL=http://ai-service:5156
SECRUX_AI_SERVICE_TOKEN=local-dev-token

# Executor Gateway (enabled by default in quickstart)
EXECUTOR_GATEWAY_ENABLED=true
EXECUTOR_GATEWAY_PORT=5155
# Optional: provide PEM cert/key for the gateway (recommended for remote executors).
# Quickstart helper:
#   ./gen-executor-gateway-certs.sh
# The compose mounts `./certs/executor-gateway` to `/certs/executor-gateway` by default.
EXECUTOR_GATEWAY_CERTIFICATE_PATH=/certs/executor-gateway/gateway.crt
EXECUTOR_GATEWAY_PRIVATE_KEY_PATH=/certs/executor-gateway/gateway.key

# -----------------------------------------------------------------------------
# AI service database (secrux-ai)
# -----------------------------------------------------------------------------
AI_POSTGRES_DB=secrux_ai
AI_POSTGRES_USER=secrux_ai
AI_POSTGRES_PASSWORD=secrux_ai
AI_DATABASE_URL=postgresql+psycopg://secrux_ai:secrux_ai@ai-postgres:5432/secrux_ai

# Optional: LLM settings (leave empty to disable live LLM calls)
SECRUX_AI_LLM_BASE_URL=
SECRUX_AI_LLM_API_KEY=
SECRUX_AI_LLM_MODEL=

# Optional: prompt dump (debug)
# off | file | stdout
SECRUX_AI_PROMPT_DUMP=off
SECRUX_AI_PROMPT_DUMP_DIR=/app/storage/prompt-dumps
